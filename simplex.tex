\section{Симплекс-метод}
\label{sec:simplex}

Симплекс-метод позволяет решать задачи линейного программирования,
заключающиеся в минимизации целевого линейного функционала при
заданных линейных ограничениях. Основной идеей симплекс-метода
является перебор вершин выпуклого многогранника в многомерном
пространстве.

\subsection{Алгоритм симплекс-метода}

Приведём описание общей схемы метода. Более подробное изложение дано в
\cite{taha05}.

Рассмотрим следующую \neword{задачу линейного программирования}:
\begin{equation}
  \label{eq:lp-problem-form-initial}
  \begin{cases}
    f(x) = \suml_{i=1}^n{\! c_i x_i} + c_{n+1} \to \min \\
    Ax = b,\, \underset{m×n}{A} = (a_{ij}),\rank{A} = m,\,b \in \set{E}^n \\
    x_i \geq 0,\, i = \overline{1, n}
  \end{cases}
\end{equation}
Как видим, она заключается в поиске таких неотрицательных значений
$x_i$, что достигается минимум линейной функции $f(x)$ при выполнении
$n$ линейных ограничений на набор $x_i$.

\begin{rem}
  Рассмотрение задачи с ограничениями лишь типа равенств не
  ограничивает общности рассуждений. Действительно, ограничение типа
  неравенства со знаком ``$\leq$''
  \begin{equation*}
    \suml_{i=1}^n a_{ij} x_i \leq b_j
  \end{equation*}
  может быть сведено к ограничению типа равенства путём введения
  дополнительной неотрицательной переменной $s_k$, называемой
  \neword{остаточной}:
  \begin{equation*}
    \suml_{i=1}^n a_{ij} x_i + s_k = b_j
  \end{equation*}

  В случае знака ``$\geq$'' ограничение типа неравенства
  \begin{equation*}
    \suml_{i=1}^n a_{ij} x_i \geq b_j
  \end{equation*}
  приводится к равенству путем введения \neword{избыточной
    переменной}:
  \begin{equation*}
    \suml_{i=1}^n a_{ij} x_i - s_k = b_j
  \end{equation*}

  В обоих случаях условие $s_k \geq 0$ добавляется к набору
  ограничений исходной задачи.
\end{rem}

Пусть исходная задача может быть приведена к следующему виду:
\begin{equation}
  \label{eq:lp-problem-form}
  \begin{cases}
    f(x) = -{\!\!\!\!\suml_{i={m+1}}^n{\!\!\!\!\Delta_{i} x_i}} + \hat{c}_{n+1} \to \min \\
    x_j + \!\! \suml_{i=m+1}^n {\!\!\!\!\alpha_{ji} x_i} = \beta_j,\,
    \beta_j \geq 0, j = \overline{1, m},\\
    x_i \geq 0,\, i = \overline{1, n}
  \end{cases}
\end{equation}

\begin{dfn}
  В задаче \eqref{eq:lp-problem-form} переменные $x_1, \dotsc, x_m$,
  которым соответствуют единичные столбцы в полученной матрице,
  называются \neword{базисными}, а $x_{m+1}, \dotsc, x_n$ —
  \neword{свободными}.
\end{dfn}

\begin{dfn}
  Решение задачи \eqref{eq:lp-problem-form} при нулевых свободных
  переменных называется \neword{базисным решением}. Если при этом все
  переменные принимают неотрицательные значения, решение называется
  \neword{допустимым}, а противном случае — \neword{недопустимым}.
\end{dfn}

Итерационный алгоритм симплекс-метода для поиска оптимального решения
перебирает ограниченное число допустимых базисных решений. В ходе
работы алгоритма на каждом шаге определённая переменная исключается из
состава базисных, а другая, наоборот, вводится в их число, что
соответствует уменьшению значения целевой функции с помощью изменения
значения одной из свободных переменных.

Для формулировки алгоритма удобно на каждом шаге использовать
следующее матричное представление задачи:

\begin{equation}
  \label{eq:lp-matrix}
  \begin{bmatrix}
    \circ  & x_1 & x_2 & \hdots & x_m   & x_{m+1} & \hdots & x_n & \diamond\\
    x_1    & 1   & 0   & \hdots & 0     & \alpha_{1,{m+1}} & \hdots & \alpha_{1,n} & \beta_1 \\
    x_2    & 0   & 1   &        & \vdots & \alpha_{2,{m+1}} & \hdots & \alpha_{2,n} & \beta_2 \\
    \vdots & \vdots &  &\vspace{2pt}\ddots  & 0      & \vdots & \ddots & \vdots & \vdots \\
    x_m   & 0       & \hdots & 0 & 1 & \alpha_{m,{m+1}} & \hdots & \alpha_{m,n} & \beta_m \\
    f & 0 & \hdots & 0 & 0 & \Delta_{m+1} & \hdots & \Delta_n & \hat{c}_{n+1}
  \end{bmatrix}
\end{equation}

  \begin{enumerate}
    \renewcommand{\labelenumi}{\textbf{Шаг \arabic{enumi}.}}
  \item Если все коэффициенты $\Delta_{m+1}, \dotsc, \Delta_n$
    неположительны, то найдено оптимальное решение $x_1 = \beta_1,
    \dotsc, x_m = \beta_m, x_{m+1} = x_n = 0$. Если найдётся $\Delta_s
    > 0$ такое, что в соответствующем столбце матрицы
    \eqref{eq:lp-matrix} все коэффициенты $\alpha_{js} \leq 0$,
    решений нет.
  \item В качестве вводимой в состав базиса свободной переменной $x_s$
    выбирается та, которой отвечает наибольший положительный
    коэффициент $\Delta_s$. Соответствующий столбец называется
    ведущим.
  \item Выбор исключаемой из базиса переменной $x_r$ производится
    таким образом, что достигается минимум отношения $\Theta =
    \frac{\beta_r}{\alpha_{rs}}$ для $\alpha_{rs} > 0$.
    Соответствующая строка называется ведущей.
  \item Осуществляется переход к новому базису — ведущая строка
    делится на $\alpha_{rs}$ и ведущий столбец путём элементарных
    преобразований приводится к виду единичного.
  \item Процесс повторяется с первого шага для нового базиса
  \end{enumerate}

\subsubsection{Метод искусственных переменных}

\subsubsection{Графическая интерпретация}

\subsection{Практический пример}

К решению предлагается следующая задача:
\begin{equation}
  \label{eq:lp-initial}
  \begin{cases}
    f(x) = -3x_1+2x_2-2x_3+2x_4-x_5 \to \min \\
    -x_1+x_2-x_3=1 \\
    -x_2+x_3+x_4=1 \\
    \phm x_2+x_3+x_5=2 \\
    \phm x_i \geq 0,\, i = \overline{1, 5}
  \end{cases}
\end{equation}

Для того, чтобы матрица коэффициентов ограничений содержала в себе
единичную, воспользуемся методом искусственных переменных, добавив в
первое ограничение переменную $x_6$ так, что оно примет вид
\begin{equation*}
  -x_1+x_2-x_3+x_6=1 \\
\end{equation*}

Заменим минимизируемую функцию на $\tilde{f}(x) = x_6$ и выразим её
через свободные переменные $x_1, x_2, x_3$, получив
\mbox{$\tilde{f}(x) = x_1-x_2+x_3+1$}. Перейдём к рассмотрению
вспомогательной задачи
\begin{equation}
  \begin{cases}
    \tilde{f}(x) = x_1-x_2+x_3+1 \to \min \\
    -x_1+x_2-x_3+x_6=1 \\
    -x_2+x_3+x_4=1 \\
    \phm x_2+x_3+x_5=2 \\
    \phm x_i \geq 0,\, i = \overline{1, 6}
  \end{cases}
\end{equation}

Решим её симплекс-методом. Составим расширенную матрицу из
коэффициентов ограничений и целевой функции:
\begin{equation}
  \begin{gmatrix}[b]
    \dagger &  x_1 &  x_2 &  x_3 & x_4 & x_5 &
    x_6 & \diamond\\
    x_6 & \mm{1} &  1 & \mm{1} & 0 & 0 & 1 & \mathbf{1} \\
    x_4 &  0 & \mm{1} &  1 & 1 & 0 & 0 & 1 \\
    x_5 &  0 &  1 &  1 & 0 & 1 & 0 & 2 \\
    \tilde{f}    & \mm{1} &  \mathbf{1} & \mm{1} & 0 & 0 & 0 & 1
  \end{gmatrix}
\end{equation}

Базисными переменными являются $x_4, x_5, x_6$. Для дальнейшего
решения необходимо исключить искусственную переменную $x_6$ из состава
базисных. 

Выберем в качестве ведущего столбец с максимальным элементом в
последней строке — это столбец переменной $x_2$, поскольку $\max\{1,
-1, 0\} = 1$. С помощью симплексного отношения выберем первую строку в
качестве ведущей, поскольку $\min\left\{\frac{1}{1},
  \frac{2}{1}\right\} = 1$.

Учитывая выбранный ведущий элемент, переведём переменную $x_2$ в
состав базисных взамен $x_6$. Сложим со второй строкой первую, а с
третьей и четвёртой — первую, умноженную на $-1$:
\begin{equation*}
  \begin{gmatrix}[b]
    \dagger & x_1 & x_2 & x_3 & x_4 & x_5 & x_6 & \diamond\\
    x_6 & \mm{1} &  \mathbf{1} &\mm{1}& 0 & 0 & 1 & 1 \\
    x_4 &  0 &\mm{1}&  1 & 1 & 0 & 0 & 1 \\
    x_5 &  0 &  1 &  1 & 0 & 1 & 0 & 2 \\
    \tilde{f} &  1&  1 &\mm{1}& 0 & 0 & 0 & 1
    \rowops
    \add{1}{2}
    \add[-1]{1}{3}
    \add[-1]{1}{4}
  \end{gmatrix}
\end{equation*}

Получим матрицу с базисными переменными $x_2, x_4, x_5$:
\begin{equation}
  \label{eq:lp-artif}
  \begin{bmatrix}
    \dagger & x_1 & x_2 & x_3 & x_4 & x_5 & x_6 & \diamond\\
    x_2 &\mm{1}&  1 &\mm{1}& 0 & 0 & 1 &  1\\
    x_4 &\mm{1}&  0 &  0 & 1 & 0 & 0 &  2\\
    x_5 &  1 &  0 &  2 & 0 & 1 & 0 &  1\\
    \tilde{f} & 0 &  0 & 0 & 0 & 0 &\mm{1}& 0
  \end{bmatrix}
\end{equation}

При этом значение функции $\tilde{f}(x)$ равно нулю, что свидетельствует
о том, что найденное решение вспомогательной задачи является
допустимым для исходной.

Отбросим искусственную переменную $x_6$ и вернёмся к начальной задаче
\eqref{eq:lp-initial}. Исключим из исходной целевой функции $f(x)$
базисные переменные $x_2, x_4$ и $x_5$, используя ограничения из
матрицы \eqref{eq:lp-artif}:
\begin{equation*}
  \begin{cases}
    -x_1+x_2-x_3=1\\
    -x_1+x_4=2\\
    \phm x_1+2x_3+x_5 = 1
  \end{cases}
\end{equation*}

Тогда $f(x)$ принимает вид
\begin{equation*}
  f(x) = 2x_1+2x_3+5
\end{equation*}

Используем эту целевую функцию в матрице ограничений \eqref{eq:lp-artif}:
\begin{equation*}
  \begin{bmatrix}
    \dagger & x_1 & x_2 & x_3 & x_4 & x_5 & \diamond\\
    x_2 &\mm{1}& 1 &\mm{1}& 0 & 0 & 1\\
    x_4 &\mm{1}& 0 &  0 & 1 & 0 & 2\\
    x_5 &  1 & 0 &  2 & 0 & 1 & 1\\
    \tilde{f} & \mm{2} & 0 & \mm{2} & 0 & 0 & 5
  \end{bmatrix}
\end{equation*}

В нижнем ряду под столбцами переменных все коэффициенты отрицательны,
что свидетельствует о том, что найдено оптимальное решение:

\begin{equation}
  \begin{cases}
    x_1 = 0\\
    x_2 = 1\\
    x_3 = 0\\
    x_4 = 2\\
    x_5 = 1
  \end{cases}
\end{equation}
